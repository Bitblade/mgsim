.\" Man page generated from reStructuredText.
.
.TH MGSIMDEV-RTC 7 "August 2012" "3.4.90-5937" ""
.SH NAME
mgsimdev-rtc \- Real time clock pseudo-device in MGSim
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.SH DESCRIPTION
.sp
The real\-time clock allows programs running on the platform to sample
real time (outside of the simulation environment) and signal
asynchronous events to the programs at configurable time periods.
.sp
An I/O device of this type can be specified in MGSim using the device
type \fBRTC\fP\&.
.SH CONFIGURATION
.INDENT 0.0
.TP
.B \fBRTCMeatSpaceUpdateInterval\fP
Mimimal real\-time interval at which the RTC will check the time and
trigger events. This defines the clock\(aqs resolution.
.UNINDENT
.sp
Note: a higher resolution will degrade the simulation speed.
.SH PROTOCOL
.SS Reading the time
.sp
When queried explicitly using \fII/O read\fP requsts, words 6\-9 provide a
broken\-down description of the current time and date, analogous to
\fBstruct tm\fP in C.
.sp
The format is as follows:
.TS
center;
|l|l|l|.
_
T{
Word
T}	T{
Bits
T}	T{
Description
T}
_
T{
6,8
T}	T{
0\-5
T}	T{
Seconds (0\-59)
T}
_
T{
6,8
T}	T{
6\-11
T}	T{
Minutes (0\-59)
T}
_
T{
6,8
T}	T{
12\-16
T}	T{
Hours (0\-23)
T}
_
T{
6,8
T}	T{
17\-21
T}	T{
Day in month (0\-30)
T}
_
T{
6,8
T}	T{
22\-25
T}	T{
Month in year (0\-11)
T}
_
T{
6,8
T}	T{
26\-31
T}	T{
Number of years since 1970 (0\-63)
T}
_
T{
7,9
T}	T{
0\-3
T}	T{
Day of week (Sunday = 0)
T}
_
T{
7,9
T}	T{
4\-12
T}	T{
Day of year (0\-365)
T}
_
T{
7,9
T}	T{
13
T}	T{
Whether summer time is in effect
T}
_
T{
7,9
T}	T{
14\-31
T}	T{
Offset from UTC in seconds (0\-86399)
T}
_
.TE
.SS Notifications
.sp
The RTC pseudo\-device can also be configured to signal (notify) the
system at specified real time intervals. This is set using word 1
(delay) and word 2 (which notification channel to use).
.sp
If the I/O bus is busy it is possible that the notification cannot be
sent for an entire period. In this case, the value of word 3
determines whether intermediate notifications are skipped or whether
they accumulate, to be delivered eventually.
.SH INTERFACE
.sp
The RTC device presents itself to the I/O bus as a single device. It
must be accessed using 32\-bit I/O operations. Its device address space
is as follows:
.TS
center;
|l|l|l|.
_
T{
32\-bit word
T}	T{
Mode
T}	T{
Description
T}
_
T{
0
T}	T{
R
T}	T{
Clock resolution in microseconds of real time
T}
_
T{
1
T}	T{
R/W
T}	T{
Notification delay (in microseconds, set to 0 to disable notifications)
T}
_
T{
2
T}	T{
R/W
T}	T{
Notification channel to use for notifications
T}
_
T{
3
T}	T{
R/W
T}	T{
Boolean: whether to deliver all events
T}
_
T{
4
T}	T{
R
T}	T{
Microseconds part of the current Greenwich time since Jan 1, 1970
T}
_
T{
5
T}	T{
R
T}	T{
Seconds part of the current Greenwich time since Jan 1, 1970
T}
_
T{
6
T}	T{
R
T}	T{
Packed UTC time/date (part 1, see below)
T}
_
T{
7
T}	T{
R
T}	T{
Packed UTC time/date (part 2, see below)
T}
_
T{
8
T}	T{
R
T}	T{
Packed local time/date (part 1, see below)
T}
_
T{
9
T}	T{
R
T}	T{
Packed local time/date (part 2, see below)
T}
_
.TE
.sp
To change the notification channel number, it is recommended to first
disable notifications (set the delay to 0), so as to cancel any
pending notification to the old channel number.
.SH SEE ALSO
.sp
mgsim(1), mgsimdoc(7)
.SH BUGS
.sp
Report bugs & suggest improvements to \fI\%microgrids@svp\-home.org\fP\&.
.SH AUTHOR
MGSim was created by Mike Lankamp. MGSim is now under
stewardship of the Microgrid project. This manual page was written
by Raphael 'kena' Poss.
.SH COPYRIGHT
Copyright (C) 2008-2012 the Microgrid project.
.\" Generated by docutils manpage writer.
.

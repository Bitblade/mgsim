.\" Man page generated from reStructuredText.
.
.TH MGSIMDEV-UART 7 "August 2012" "3.4.90-5937" ""
.SH NAME
mgsimdev-uart \- Serial UART pseudo-device in MGSim
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.SH DESCRIPTION
.sp
The MG UART device allows to connect the Microgrid to an external
(serial) terminal. It tries to mimics the NS/PC16550D standard
Universal Asynchronous Receiver\-Transmitter (UART) chip.
.sp
An I/O device of this type can be specified in MGSim using the device
type \fBUART\fP\&.
.SH CONFIGURATION
.sp
Each \fBuart\fP device support the following configuration variables:
.INDENT 0.0
.TP
.B \fB<dev>:UARTInputFIFOSize\fP, \fB<dev>:UARTOutputFIFOSize\fP
Number of bytes held by the UART FIFO.
.TP
.B \fB<dev>:UARTConnectMode\fP
How the UART is connected to the "outside world" (the environment
where the simulation is run). Can be either of the following:
.INDENT 7.0
.TP
.B \fBFILE\fP
Data is read/written from/to a standard file, whose name
is specified by \fB<dev>:UARTFile\fP\&.
.TP
.B \fBFILEPAIR\fP
Data is read from one file, and written to another. The two
file names are specified with \fB<dev>:UARTInputFile\fP and
\fB<dev>:UARTOutputFile\fP\&.
.TP
.B \fBSTDIO\fP
The UART is connected to the standard Unix input and output
streams of MGSim itself. Note that this mode is incompatible
with MGSim\(aqs interactive mode (\fB\-i\fP).
.TP
.B \fBPTY\fP
A POSIX pseudo\-terminal (pty) is allocated and connected to
the UART. The corresponding slave device is printed
by MGSim prior to the simulation start\-up.
.UNINDENT
.UNINDENT
.SH PROTOCOL
.sp
The pseudo\-device follows the protocol of the standard NS/PC16650D
chip, with the following exceptions:
.INDENT 0.0
.IP \(bu 2
Line and MODEM status are not supported. However loopback mode can be
configured and used (MCR4)
.IP \(bu 2
the FIFO mode is always enabled, and cannot be disabled (FCR0 is
fixed to 1).
.IP \(bu 2
the FIFO buffers cannot be reset (FCR1/2 are inoperative)
.IP \(bu 2
DMA is not supported (FCR3 is inoperative)
.IP \(bu 2
transmit speed / divisor latch is not supported (and DLAB is inoperative)
.UNINDENT
.SH INTERFACE
.sp
The UART device presents itself to the I/O bus as a single device. It
must be accessed using 8\-bit I/O operations. Its device address space
follows the NS/PC16550D specification as follows:
.TS
center;
|l|l|l|.
_
T{
Register
T}	T{
Mode
T}	T{
Description
T}
_
T{
0
T}	T{
R
T}	T{
Receiver Buffer Register / FIFO input
T}
_
T{
0
T}	T{
W
T}	T{
Transmit Hold Register (THR) / FIFO output
T}
_
T{
1
T}	T{
R/W
T}	T{
Interrupt Enable Register (IER)
T}
_
T{
2
T}	T{
R
T}	T{
Interrupt Identification Register (IIR)
T}
_
T{
2
T}	T{
W
T}	T{
FIFO Control Register (FCR)
T}
_
T{
3
T}	T{
R/W
T}	T{
Line Control Register (LCR)
T}
_
T{
4
T}	T{
R/W
T}	T{
MODEM Control Register (MCR)
T}
_
T{
5
T}	T{
R/W
T}	T{
Line Status Register (LSR)
T}
_
T{
6
T}	T{
R/W
T}	T{
MODEM Status Register (MSR)
T}
_
T{
7
T}	T{
R/W
T}	T{
Scratch register
T}
_
T{
8
T}	T{
R/W
T}	T{
(MG extension) Interrupt channel for THRE interrupts
T}
_
T{
9
T}	T{
R/W
T}	T{
(MG extension) Interrupt channel for output FIFO underruns
T}
_
T{
10
T}	T{
R/W
T}	T{
(MG extension) UART enable/disable
T}
_
.TE
.sp
To change the notification channel number, it is recommended to first
disable notifications (reset IER1), so as to cancel any pending
notification to the old channel number.
.SH SEE ALSO
.INDENT 0.0
.IP \(bu 2
mgsim(1), mgsimdoc(7)
.IP \(bu 2
NS/PC16650D specification: \fI\%http://www.national.com/ds/PC/PC16550D.pdf\fP
.UNINDENT
.SH BUGS
.sp
Report bugs & suggest improvements to \fI\%microgrids@svp\-home.org\fP\&.
.SH AUTHOR
MGSim was created by Mike Lankamp. MGSim is now under
stewardship of the Microgrid project. This manual page was written
by Raphael 'kena' Poss.
.SH COPYRIGHT
Copyright (C) 2008-2012 the Microgrid project.
.\" Generated by docutils manpage writer.
.
